
<!DOCTYPE html>

<html>
<head>
<title>WORK_ORDER_EM</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h2 { color: #2c3e50; }
        input[type="file"] { margin-bottom: 20px; }
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f4f4f4; }
        tr:nth-child(even) { background-color: #f9f9f9; }
    </style>
<style>
#filter-container {
    margin-bottom: 20px;
    padding: 10px;
    background-color: #f2f2f2;
    border-radius: 8px;
}
#filter-container label {
    margin-right: 10px;
}
#filter-container input {
    margin-right: 20px;
}
#excel-table {
    margin-top: 20px;
    border-collapse: collapse;
    width: 100%;
}
#excel-table th, #excel-table td {
    border: 1px solid #ddd;
    padding: 8px;
}
#excel-table th {
    background-color: #4CAF50;
    color: white;
}
</style></head>
<body>
<h2>WORK_ORDER_EM</h2>
<input accept=".xlsx" id="upload" type="file"/>
<div id="table-container"></div>
<script>
        document.getElementById('upload').addEventListener('change', function(e) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const sheetName = workbook.SheetNames[0];
                const sheet = workbook.Sheets[sheetName];
                const jsonData = XLSX.utils.sheet_to_json(sheet, { defval: "" });

                if (jsonData.length === 0) {
                    document.getElementById('table-container').innerHTML = "<p>No data found in the Excel sheet.</p>";
                    return;
                }

                const table = document.createElement('table');
                const thead = document.createElement('thead');
                const tbody = document.createElement('tbody');

                // Create table header
                const headerRow = document.createElement('tr');
                Object.keys(jsonData[0]).forEach(col => {
                    const th = document.createElement('th');
                    th.textContent = col.trim();
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);

                // Create table rows
                jsonData.forEach(row => {
                    const tr = document.createElement('tr');
                    Object.keys(jsonData[0]).forEach(col => {
                        const td = document.createElement('td');
                        td.textContent = row[col] || "";
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });

                table.appendChild(thead);
                table.appendChild(tbody);
                document.getElementById('table-container').innerHTML = "";
                document.getElementById('table-container').appendChild(table);
            };
            reader.readAsArrayBuffer(e.target.files[0]);
        });
    </script>
</body>
</html>
