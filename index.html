<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WORK_ORDER_EM</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .menu { margin-bottom: 20px; }
    table { border-collapse: collapse; margin-top: 10px; width: 90%; font-size: 12px; }
    th, td { border: 1px solid #999; padding: 5px; text-align: center; }
    th { background: #f2f2f2; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h2>WORK_ORDER_EM</h2>

  <!-- Menu Buttons -->
  <div class="menu">
    <button onclick="showMenu(1)">Work Order</button>
    <button onclick="showMenu(2)">Detail Part</button>
    <button onclick="showMenu(3)">External Job</button>
  </div>

  <!-- Menu 1 -->
  <div id="menu1" class="menu-content">
    <h3>Menu 1 - Work Order</h3>
    <input type="file" id="fileMenu1" accept=".xlsx,.xls" />
    <div id="outputMenu1"></div>
  </div>

  <!-- Menu 2 -->
  <div id="menu2" class="menu-content hidden">
    <h3>Menu 2 - Detail Part</h3>
    <input type="file" id="fileMenu2" accept=".xlsx,.xls" />
    <div id="outputMenu2"></div>
  </div>

  <!-- Menu 3 -->
  <div id="menu3" class="menu-content hidden">
    <h3>Menu 3 - External Job</h3>
    <input type="file" id="fileMenu3" accept=".xlsx,.xls" />
    <div id="outputMenu3"></div>
  </div>

  <script>
    function showMenu(num) {
      document.querySelectorAll(".menu-content").forEach(div => div.classList.add("hidden"));
      document.getElementById("menu" + num).classList.remove("hidden");
    }

    // Fungsi umum untuk render Excel ke tabel
    function renderTable(jsonData, outputId) {
      if (jsonData.length === 0) return;
      let table = "<table><thead><tr>";
      Object.keys(jsonData[0]).forEach(key => table += <th>${key}</th>);
      table += "</tr></thead><tbody>";
      jsonData.forEach(row => {
        table += "<tr>";
        Object.values(row).forEach(val => table += <td>${val ?? ""}</td>);
        table += "</tr>";
      });
      table += "</tbody></table>";
      document.getElementById(outputId).innerHTML = table;
    }

    // Handler Upload untuk tiap menu
    function handleFileMenu(fileInput, outputId) {
      const file = fileInput.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: "array" });
        const sheet = workbook.SheetNames[0];
        const jsonData = XLSX.utils.sheet_to_json(workbook.Sheets[sheet]);
        renderTable(jsonData, outputId);
      };
      reader.readAsArrayBuffer(file);
    }

    // Event listener untuk tiap menu
    document.getElementById("fileMenu1").addEventListener("change", e => handleFileMenu(e.target, "outputMenu1"));
    document.getElementById("fileMenu2").addEventListener("change", e => handleFileMenu(e.target, "outputMenu2"));
    document.getElementById("fileMenu3").addEventListener("change", e => handleFileMenu(e.target, "outputMenu3"));
  </script>
</body>
</html>
